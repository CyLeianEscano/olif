<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Campus Lost &amp; Found</title>
    <link rel="stylesheet" href="/css/styles.css" />
  </head>
  <body>
    <div class="app-shell">
      <div class="card">
        <div class="card-inner">
          <header class="app-header">
            <div class="brand">
              <div class="brand-logo">LF</div>
              <div class="brand-text">
                <div class="brand-title">Campus Lost &amp; Found</div>
                <div class="brand-subtitle">
                  Please register or log in before reporting or searching.
                </div>
              </div>
            </div>
            <div class="badge-muted">
              User: <span id="current-user-name">Guest</span>
            </div>
          </header>

          <div class="layout-two-col">
            <main>
              <h1 class="page-title">Get started</h1>
              <p class="page-description">
                Students must create an account or log in first. After that, you can report lost items or search
                already found items.
              </p>

              <div class="form-card" style="margin-bottom: 16px;">
                <h2 class="page-title" style="font-size: 16px;">Login</h2>
                <form id="userLoginForm" class="form-grid">
                  <div class="form-grid-full">
                    <label class="field-label">
                      Full name
                      <span class="required">*</span>
                    </label>
                    <input class="input" type="text" id="userFullName" placeholder="Your full name" />
                  </div>
                  <div class="form-grid-full">
                    <label class="field-label">
                      Password
                      <span class="required">*</span>
                    </label>
                    <input class="input" type="password" id="userPassword" placeholder="Password" />
                  </div>
                  <div class="actions-row">
                    <button type="submit" class="button button-primary">
                      Login
                    </button>
                  </div>
                </form>
              </div>

              <div class="form-card">
                <h2 class="page-title" style="font-size: 16px;">Register</h2>
                <form id="registerForm" class="form-grid">
                  <div class="form-grid-full">
                    <label class="field-label">
                      Full name
                      <span class="required">*</span>
                    </label>
                    <input class="input" type="text" id="regFullName" placeholder="Your full name" />
                  </div>
                  <div>
                    <label class="field-label">
                      College
                      <span class="required">*</span>
                    </label>
                    <select class="select" id="regCollege">
                      <option value="">Select college</option>
                      <option>CAS</option>
                      <option>CBA</option>
                      <option>CCJE</option>
                      <option>CEA</option>
                      <option>CIT</option>
                      <option>CMS</option>
                      <option>CCS</option>
                      <option>CTE</option>
                      <option>COT</option>
                      <option>LHS</option>
                    </select>
                  </div>
                  <div>
                    <label class="field-label">
                      Year and section
                      <span class="required">*</span>
                    </label>
                    <input class="input" type="text" id="regYearSection" placeholder="3A, 2-B, etc." />
                  </div>
                  <div class="form-grid-full">
                    <label class="field-label">
                      Password
                      <span class="required">*</span>
                    </label>
                    <input class="input" type="password" id="regPassword" placeholder="Password" />
                  </div>
                  <div class="actions-row">
                    <button type="submit" class="button button-primary">
                      Register
                    </button>
                  </div>
                </form>
              </div>
            </main>

            <aside>
              <div id="admin-summary" style="margin-top: 12px;"></div>

              <div class="form-card">
                <h2 class="page-title" style="font-size: 14px;">Admin login</h2>
                <form id="adminLoginForm" class="form-grid">
                  <div class="form-grid-full">
                    <label class="field-label">
                      Username
                      <span class="required">*</span>
                    </label>
                    <input class="input" type="text" id="adminUsername" placeholder="admin username" />
                  </div>
                  <div class="form-grid-full">
                    <label class="field-label">
                      Password
                      <span class="required">*</span>
                    </label>
                    <input class="input" type="password" id="adminPassword" placeholder="Admin password" />
                  </div>
                  <div class="actions-row">
                    <button type="submit" class="button button-primary">
                      Login as admin
                    </button>
                  </div>
                </form>
              </div>
            </aside>
          </div>
        </div>
      </div>
    </div>

    <script>
      document.getElementById("userLoginForm").addEventListener("submit", async (e) => {
        e.preventDefault();
        const body = {
          fullName: document.getElementById("userFullName").value,
          password: document.getElementById("userPassword").value
        };
        const res = await fetch("/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(body)
        });
        const data = await res.json();
        if (res.ok) {
          localStorage.setItem("currentUser", JSON.stringify(data));
          window.location.href = "/user-dashboard.html";
        } else {
          alert("User login failed: " + data.error);
        }
      });

      document.getElementById("adminLoginForm").addEventListener("submit", async (e) => {
        e.preventDefault();
        const body = {
          username: document.getElementById("adminUsername").value,
          password: document.getElementById("adminPassword").value
        };
        const res = await fetch("/admin-login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(body)
        });
        const data = await res.json();
        if (res.ok) {
          localStorage.setItem("currentUser", JSON.stringify(data));
          window.location.href = "/admin-dashboard.html";
        } else {
          alert("Admin login failed: " + data.error);
        }
      });

      document.getElementById("registerForm").addEventListener("submit", async (e) => {
        e.preventDefault();
        const body = {
          fullName: document.getElementById("regFullName").value,
          college: document.getElementById("regCollege").value,
          yearAndSection: document.getElementById("regYearSection").value,
          password: document.getElementById("regPassword").value
        };
        const res = await fetch("/register", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(body)
        });
        const data = await res.json();
        if (res.ok) {
          alert("Registered successfully, now login.");
        } else {
          alert("Register failed: " + data.error);
        }
      });
    </script>
  </body>
</html>